<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards - FarmaLearn</title>
    
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Estilos -->
    <link rel="stylesheet" href="css/styles.css">
    
    <style>
        /* Estilos específicos para a página de flashcards */
        .flashcard-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .flashcard-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .flashcard-filters select {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--card-background);
            color: var(--text-color);
        }
        
        .flashcard-progress {
            text-align: center;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .flashcard-back-content {
            width: 100%;
        }
        
        .flashcard-section {
            margin-bottom: 15px;
        }
        
        .flashcard-section-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .flashcard-medication {
            background-color: rgba(0, 0, 0, 0.03);
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
        }
        
        .flashcard-medication-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .flashcard-medication-detail {
            font-size: 0.9rem;
            margin-bottom: 3px;
        }
        
        .flashcard-list {
            list-style-type: disc;
            padding-left: 20px;
            margin-bottom: 10px;
        }
        
        .flashcard-list li {
            margin-bottom: 5px;
        }
        
        .difficulty-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-difficulty {
            padding: 8px 16px;
            border-radius: 5px;
            font-weight: 500;
            min-width: 100px;
        }
        
        .btn-easy {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-medium {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-hard {
            background-color: var(--error-color);
            color: white;
        }
        
        .session-complete {
            text-align: center;
            padding: 40px 20px;
        }
        
        .session-complete-icon {
            font-size: 3rem;
            color: var(--success-color);
            margin-bottom: 20px;
        }
        
        .session-complete-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .session-complete-stats {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .session-stat {
            text-align: center;
        }
        
        .session-stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .session-stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .session-actions {
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <div class="main-content">
        <!-- Barra lateral -->
        <div class="sidebar">
            <div class="sidebar-fixed">
                <div class="logo-container">
                    <img src="img/logo.png" alt="FarmaLearn Logo" class="logo" id="logo-placeholder">
                </div>
                
                <div class="user-info">
                    <div class="user-avatar">JU</div>
                    <div class="user-details">
                        <div class="user-name">Juliano</div>
                        <div class="user-role">Balconista</div>
                    </div>
                </div>
                
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">
                            <i class="fas fa-home nav-icon"></i>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="flashcards.html" class="nav-link active">
                            <i class="fas fa-clone nav-icon"></i>
                            Flashcards
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="simulador.html" class="nav-link">
                            <i class="fas fa-comments nav-icon"></i>
                            Simulador
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="estatisticas.html" class="nav-link">
                            <i class="fas fa-chart-bar nav-icon"></i>
                            Estatísticas
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="conquistas.html" class="nav-link">
                            <i class="fas fa-trophy nav-icon"></i>
                            Conquistas
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="configuracoes.html" class="nav-link">
                            <i class="fas fa-cog nav-icon"></i>
                            Configurações
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Conteúdo principal -->
        <div class="content">
            <div class="container">
                <h1>Flashcards</h1>
                <p>Estude medicamentos de venda livre com flashcards interativos.</p>
                
                <!-- Filtros e controles -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Iniciar sessão de estudo</h2>
                    </div>
                    <div class="card-body">
                        <div class="flashcard-filters">
                            <div class="form-group">
                                <label class="form-label">Categoria</label>
                                <select id="categoria-filter" class="form-control">
                                    <option value="">Todas as categorias</option>
                                    <option value="Respiratório">Problemas Respiratórios</option>
                                    <option value="Dermatológico">Problemas Dermatológicos</option>
                                    <option value="Dores">Dores</option>
                                    <option value="Digestivo">Problemas Digestivos</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Público</label>
                                <select id="publico-filter" class="form-control">
                                    <option value="">Todos os públicos</option>
                                    <option value="Adulto">Adulto</option>
                                    <option value="Infantil">Infantil</option>
                                    <option value="Idoso">Idoso</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Quantidade</label>
                                <select id="quantidade-filter" class="form-control">
                                    <option value="5">5 flashcards</option>
                                    <option value="10" selected>10 flashcards</option>
                                    <option value="15">15 flashcards</option>
                                    <option value="20">20 flashcards</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="flashcard-controls">
                            <button id="start-session" class="btn btn-primary">Iniciar sessão de estudo</button>
                        </div>
                    </div>
                </div>
                
                <!-- Área de estudo de flashcards -->
                <div id="study-area" style="display: none;">
                    <div class="flashcard-progress">
                        <span id="current-card">1</span> de <span id="total-cards">10</span> flashcards
                    </div>
                    
                    <div class="flashcard-container">
                        <div class="flashcard" id="flashcard">
                            <div class="flashcard-front">
                                <div class="flashcard-category" id="card-category">Categoria: Respiratório</div>
                                <div class="flashcard-id" id="card-id">RESP-A-01</div>
                                <div class="flashcard-content" id="card-front">
                                    Gripe e resfriado com febre e dor no corpo
                                </div>
                                <div class="flashcard-actions">
                                    <button id="flip-card" class="btn btn-primary">Ver resposta</button>
                                </div>
                            </div>
                            
                            <div class="flashcard-back">
                                <div class="flashcard-category" id="card-back-category">Categoria: Respiratório</div>
                                <div class="flashcard-id" id="card-back-id">RESP-A-01</div>
                                
                                <div class="flashcard-back-content" id="card-back-content">
                                    <div class="flashcard-section">
                                        <div class="flashcard-section-title">Medicamentos recomendados:</div>
                                        <div class="flashcard-medication">
                                            <div class="flashcard-medication-name">Paracetamol 500mg ou 750mg</div>
                                            <div class="flashcard-medication-detail"><strong>Posologia:</strong> 1 comprimido a cada 6 horas (máximo 4 comprimidos por dia)</div>
                                            <div class="flashcard-medication-detail"><strong>Duração:</strong> Enquanto persistirem os sintomas, por até 5 dias</div>
                                            <div class="flashcard-medication-detail"><strong>Contraindicações:</strong> Alergia ao paracetamol, doença hepática grave</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flashcard-section">
                                        <div class="flashcard-section-title">Orientações não farmacológicas:</div>
                                        <ul class="flashcard-list">
                                            <li>Manter boa hidratação (pelo menos 2 litros de água por dia)</li>
                                            <li>Repouso adequado</li>
                                            <li>Umidificar o ambiente</li>
                                            <li>Evitar mudanças bruscas de temperatura</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="flashcard-section">
                                        <div class="flashcard-section-title">Sinais de alerta:</div>
                                        <ul class="flashcard-list">
                                            <li>Febre acima de 38,5°C por mais de 3 dias</li>
                                            <li>Dificuldade para respirar</li>
                                            <li>Dor intensa no peito</li>
                                            <li>Confusão mental</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="difficulty-buttons">
                                    <button class="btn btn-difficulty btn-hard" data-difficulty="dificil">Difícil</button>
                                    <button class="btn btn-difficulty btn-medium" data-difficulty="media">Médio</button>
                                    <button class="btn btn-difficulty btn-easy" data-difficulty="facil">Fácil</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tela de sessão completa -->
                <div id="session-complete" class="card" style="display: none;">
                    <div class="card-body">
                        <div class="session-complete">
                            <div class="session-complete-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="session-complete-title">Sessão de estudo concluída!</div>
                            <div class="session-complete-message">
                                Você completou sua sessão de estudo. Continue praticando regularmente para melhorar seu conhecimento.
                            </div>
                            
                            <div class="session-complete-stats">
                                <div class="session-stat">
                                    <div class="session-stat-value" id="cards-studied">10</div>
                                    <div class="session-stat-label">Flashcards estudados</div>
                                </div>
                                
                                <div class="session-stat">
                                    <div class="session-stat-value" id="easy-cards">6</div>
                                    <div class="session-stat-label">Fáceis</div>
                                </div>
                                
                                <div class="session-stat">
                                    <div class="session-stat-value" id="medium-cards">3</div>
                                    <div class="session-stat-label">Médios</div>
                                </div>
                                
                                <div class="session-stat">
                                    <div class="session-stat-value" id="hard-cards">1</div>
                                    <div class="session-stat-label">Difíceis</div>
                                </div>
                            </div>
                            
                            <div class="session-actions">
                                <button id="new-session" class="btn btn-primary">Nova sessão</button>
                                <a href="index.html" class="btn btn-outline">Voltar ao Dashboard</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Botão de alternância de tema -->
    <div class="theme-toggle">
        <i class="fas fa-moon"></i>
    </div>
    
    <!-- Scripts -->
    <script type="module">
        import ThemeManager from './js/theme.js';
        import FlashcardSystem from './js/flashcards.js';
        
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializa o gerenciador de tema
            const themeManager = new ThemeManager();
            themeManager.initThemeToggle();
            
            // Gerar logo placeholder se a imagem não existir
            const logoPlaceholder = document.getElementById('logo-placeholder');
            logoPlaceholder.onerror = function() {
                this.onerror = null;
                this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiB2aWV3Qm94PSIwIDAgMTUwIDYwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0zMCAxMEMyMC41NyAxMCAxMyAxNy41NyAxMyAyN0MxMyAzNi40MyAyMC41NyA0NCAzMCA0NEMzOS40MyA0NCA0NyAzNi40MyA0NyAyN0M0NyAxNy41NyAzOS40MyAxMCAzMCAxMFoiIGZpbGw9IiMxRTg0NDkiLz48cGF0aCBkPSJNMzUgMjBMMjUgMjdMMzUgMzRWMjBaIiBmaWxsPSJ3aGl0ZSIvPjx0ZXh0IHg9IjU1IiB5PSIzMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iIzFFODQ0OSI+RmFybWFMZWFybjwvdGV4dD48L3N2Zz4=';
            };
            
            // Inicializa o sistema de flashcards
            const flashcardSystem = new FlashcardSystem();
            let currentSession = [];
            let currentCardIndex = 0;
            let sessionStats = {
                total: 0,
                easy: 0,
                medium: 0,
                hard: 0
            };
            
            // Elementos da interface
            const startSessionBtn = document.getElementById('start-session');
            const studyArea = document.getElementById('study-area');
            const sessionCompleteScreen = document.getElementById('session-complete');
            const flashcardElement = document.getElementById('flashcard');
            const flipCardBtn = document.getElementById('flip-card');
            const difficultyButtons = document.querySelectorAll('.btn-difficulty');
            const newSessionBtn = document.getElementById('new-session');
            
            // Contadores
            const currentCardCounter = document.getElementById('current-card');
            const totalCardsCounter = document.getElementById('total-cards');
            
            // Elementos do flashcard
            const cardCategory = document.getElementById('card-category');
            const cardId = document.getElementById('card-id');
            const cardFront = document.getElementById('card-front');
            const cardBackCategory = document.getElementById('card-back-category');
            const cardBackId = document.getElementById('card-back-id');
            const cardBackContent = document.getElementById('card-back-content');
            
            // Elementos da tela de conclusão
            const cardsStudiedElement = document.getElementById('cards-studied');
            const easyCardsElement = document.getElementById('easy-cards');
            const mediumCardsElement = document.getElementById('medium-cards');
            const hardCardsElement = document.getElementById('hard-cards');
            
            // Inicia uma nova sessão de estudo
            startSessionBtn.addEventListener('click', function() {
                const categoriaFilter = document.getElementById('categoria-filter').value;
                const publicoFilter = document.getElementById('publico-filter').value;
                const quantidadeFilter = parseInt(document.getElementById('quantidade-filter').value);
                
                // Cria a sessão de estudo
                currentSession = flashcardSystem.createStudySession(
                    quantidadeFilter,
                    categoriaFilter || null,
                    publicoFilter || null
                );
                
                if (currentSession.length === 0) {
                    alert('Não há flashcards disponíveis com os filtros selecionados.');
                    return;
                }
                
                // Reseta estatísticas da sessão
                sessionStats = {
                    total: currentSession.length,
                    easy: 0,
                    medium: 0,
                    hard: 0
                };
                
                // Atualiza contadores
                currentCardIndex = 0;
                currentCardCounter.textContent = '1';
                totalCardsCounter.textContent = currentSession.length;
                
                // Mostra a área de estudo
                studyArea.style.display = 'block';
                sessionCompleteScreen.style.display = 'none';
                
                // Carrega o primeiro flashcard
                loadCurrentCard();
            });
            
            // Carrega o flashcard atual
            function loadCurrentCard() {
                if (currentCardIndex >= currentSession.length) {
                    showSessionComplete();
                    return;
                }
                
                const card = currentSession[currentCardIndex];
                
                // Atualiza o contador
                currentCardCounter.textContent = (currentCardIndex + 1).toString();
                
                // Atualiza o conteúdo do flashcard
                cardCategory.textContent = `Categoria: ${card.categoria}`;
                cardId.textContent = card.id;
                cardFront.textContent = card.frente;
                
                cardBackCategory.textContent = `Categoria: ${card.categoria}`;
                cardBackId.textContent = card.id;
                
                // Gera o conteúdo do verso do flashcard
                let backContent = '';
                
                // Medicamentos
                if (card.verso.medicamentos && card.verso.medicamentos.length > 0) {
                    backContent += '<div class="flashcard-section">';
                    backContent += '<div class="flashcard-section-title">Medicamentos recomendados:</div>';
                    
                    card.verso.medicamentos.forEach(med => {
                        backContent += '<div class="flashcard-medication">';
                        backContent += `<div class="flashcard-medication-name">${med.nome}</div>`;
                        backContent += `<div class="flashcard-medication-detail"><strong>Posologia:</strong> ${med.posologia}</div>`;
                        backContent += `<div class="flashcard-medication-detail"><strong>Duração:</strong> ${med.duracao}</div>`;
                        backContent += `<div class="flashcard-medication-detail"><strong>Contraindicações:</strong> ${med.contraindicacoes}</div>`;
                        backContent += '</div>';
                    });
                    
                    backContent += '</div>';
                }
                
                // Orientações
                if (card.verso.orientacoes && card.verso.orientacoes.length > 0) {
                    backContent += '<div class="flashcard-section">';
                    backContent += '<div class="flashcard-section-title">Orientações não farmacológicas:</div>';
                    backContent += '<ul class="flashcard-list">';
                    
                    card.verso.orientacoes.forEach(orientacao => {
                        backContent += `<li>${orientacao}</li>`;
                    });
                    
                    backContent += '</ul></div>';
                }
                
                // Sinais de alerta
                if (card.verso.sinaisAlerta && card.verso.sinaisAlerta.length > 0) {
                    backContent += '<div class="flashcard-section">';
                    backContent += '<div class="flashcard-section-title">Sinais de alerta:</div>';
                    backContent += '<ul class="flashcard-list">';
                    
                    card.verso.sinaisAlerta.forEach(sinal => {
                        backContent += `<li>${sinal}</li>`;
                    });
                    
                    backContent += '</ul></div>';
                }
                
                cardBackContent.innerHTML = backContent;
                
                // Reseta o estado do flashcard
                flashcardElement.classList.remove('flipped');
            }
            
            // Virar o flashcard
            flipCardBtn.addEventListener('click', function() {
                flashcardElement.classList.add('flipped');
            });
            
            // Registra a resposta e avança para o próximo flashcard
            difficultyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const difficulty = this.getAttribute('data-difficulty');
                    const currentCard = currentSession[currentCardIndex];
                    
                    // Registra a resposta
                    flashcardSystem.registerResponse(currentCard.id, difficulty);
                    
                    // Atualiza estatísticas da sessão
                    if (difficulty === 'facil') {
                        sessionStats.easy++;
                    } else if (difficulty === 'media') {
                        sessionStats.medium++;
                    } else if (difficulty === 'dificil') {
                        sessionStats.hard++;
                    }
                    
                    // Avança para o próximo flashcard
                    currentCardIndex++;
                    loadCurrentCard();
                });
            });
            
            // Mostra a tela de sessão completa
            function showSessionComplete() {
                studyArea.style.display = 'none';
                sessionCompleteScreen.style.display = 'block';
                
                // Atualiza estatísticas
                cardsStudiedElement.textContent = sessionStats.total;
                easyCardsElement.textContent = sessionStats.easy;
                mediumCardsElement.textContent = sessionStats.medium;
                hardCardsElement.textContent = sessionStats.hard;
            }
            
            // Inicia uma nova sessão
            newSessionBtn.addEventListener('click', function() {
                sessionCompleteScreen.style.display = 'none';
                
                // Reseta os filtros
                document.getElementById('categoria-filter').value = '';
                document.getElementById('publico-filter').value = '';
                document.getElementById('quantidade-filter').value = '10';
            });
            
            // Verifica se há parâmetros na URL para iniciar uma sessão específica
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('categoria')) {
                const categoria = urlParams.get('categoria');
                document.getElementById('categoria-filter').value = categoria;
                startSessionBtn.click();
            }
        });
    </script>
</body>
</html>
